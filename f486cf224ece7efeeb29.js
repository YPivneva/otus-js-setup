const apiKey="779191065caba280063e1cd1f4862b12",form=document.querySelector("#form"),cityForm=document.querySelector("#enter-city"),histotyList=document.querySelector("#histoty-list"),weatherSign=document.querySelector("#text-city");function createError(e){document.querySelector(".weather-relevance").remove();const t=`\n      <div class="weather-relevance">\n          <div class="weather__city">Город <b>${e}</b> не найден. \n          Введите корректное название города.</div>\n      </div>`;weatherSign.insertAdjacentHTML("afterend",t)}function getWeather(e){return fetch(`https://api.openweathermap.org/data/2.5/weather?q=\n              ${e}&appid=${apiKey}&lang=ru`).then((t=>{if(!t.ok)throw createError(e),new Error(t.statusText);return t.json()}))}function removeWeather(){const e=document.querySelector(".weather-relevance"),t=document.querySelector(".weather-sign__img");e&&e.remove(),t&&t.remove()}function createWeather(e){removeWeather();const t=`\n      <div class="weather-relevance">\n          <div class="weather__city">\n            ${Math.round(parseFloat(e.main.temp)-273)}°C\n          </div>\n          <div class="weather__temp">${e.name}</div>\n      </div>\n      <img class="weather-sign__img" \n      src="https://openweathermap.org/img/wn/${e.weather[0].icon}@2x.png" \n      alt="Значок погоды" />\n  `;weatherSign.insertAdjacentHTML("afterend",t)}function addToHistory(e){if(!histotyList.innerHTML.includes(e)){const t=`\n          <li>${e}</li>\n      `;histotyList.insertAdjacentHTML("afterbegin",t)}}function removeExtraHistoryItems(){const e=document.querySelectorAll("li");if(e.length>10)for(let t=10;t<e.length;t++)e[t].remove()}const map=document.querySelector("#map-city");function success(e){map.src=`https://www.openstreetmap.org/export/embed.html?bbox=${e.coord.lon}%2C${e.coord.lat}&amp;layer=mapnik`}histotyList.addEventListener("click",(e=>{if("LI"===e.target.tagName){getWeather(e.target.textContent).then((e=>{removeWeather(),createWeather(e),success(e)}))}})),document.addEventListener("DOMContentLoaded",(()=>{!function(){const e=document.querySelector("#status");navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){const{longitude:t,latitude:r}=e.coords;document.querySelector("#map-city").src=`https://www.openstreetmap.org/export/embed.html?bbox=${t}%2C${r}&amp;layer=mapnik`,function(e,t,r){return fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${t}&lon=${r}&appid=${apiKey}&lang=ru`).then((e=>{if(!e.ok)throw new Error(e.statusText);return e.json()}))}(0,r,t).then((e=>{createWeather(e)})).catch((e=>{console.error("Ошибка получения данных о погоде:",e)}))}),(function(){e.textContent="не получается определить вашу геолокацию"})):e.textContent="Приложение не может определить местоположение"}()})),form.onsubmit=function(e){e.preventDefault();getWeather(cityForm.value.trim()).then((e=>{"404"===e.cod?(removeWeather(),createError(e)):(removeWeather(),createWeather(e),addToHistory(e.name),removeExtraHistoryItems(),success(e))}))};